library(ggplot2)
library(tidyverse)
library(dplyr)
library(foreach)
library(mosaic)
library(LICORS)
library(factoextra)
library(reshape2)
library(data.table)
library(MASS)
covid = read.csv("covidzargham.csv")
ggplot(covid)+ geom_point(mapping = aes(days_since_first_infection1, cases))
lm1 = lm(ln_cases ~ days_since_first_infection1, data = covid)
summary(lm1)
covid$ln_cases = log(covid$cases)
covid$ln_pop = log(covid$ET_Total_Population)
covid$ln_households = log(covid$totalhouseholds)
lm1 = lm(ln_cases ~ days_since_first_infection1, data = covid)
summary(lm1)
exp(0.083269)
View(covid)
summary(covid)
lm1 = lm(ln_cases ~ days_since_first_infection1+ ln_pop + Density.per.square.mile.of.land.area...Housing.units +Density.per.square.mile.of.land.area...Population+
stayhome+restaurant.dine.in+ workplaces_percent_change_from_baseline, data = covid)
summary(lm1)
lm1 = lm(ln_cases ~ days_since_first_infection1+ ln_pop+Density.per.square.mile.of.land.area...Population+
stayhome+restaurant.dine.in+ workplaces_percent_change_from_baseline, data = covid)
summary(lm1)
install.packages("NBZIMM")
library(NBZIMM)
library(remotes)
install_github("nyiuab/NBZIMM", force=T, build_vignettes=T)
library(NBZIMM)
######GLM Negative binomial model
covid2 = covid[, c(1:12, 16:30, 34,35, 37, 40 ,81:89 ,54:78)]
View(covid2)
covid2= covid2[,-c(38:40)]
X = covid2[,c(13:62)]
######GLM Negative binomial model
covid2 = covid[, c(1:12, 16:30, 34,35, 37, 40 ,81:89 ,54:78)]
covid2= covid2[,-c(35:36)]
X = covid2[,c(13:62)]
X = scale(X, center = TRUE, scale = TRUE)
View(X)
glmdata = (cbind(covid2[,c(1:12)]), X)
glmdata = cbind(covid2[,c(1:12)], X)
colnames(glmdata)
View(glmdata)
glmdata = data.frame(glmdata)
View(glmdata)
summary(glmdata)
lm4 = glm.nb(ln_cases ~.-fips.x-county-state.x-cases-deaths, data =glmdata )
lm4 = glm.nb(log(cases) ~.-fips.x-county-state.x-deaths-ln_cases, data =glmdata )
summary(lm4)
yhat = predict(lm4)
orig = data.frame(cbind(exp(yhat), glmdata$cases))
View(orig)
y = exp(yhat)
lm4 = glm.nb(cases ~.-fips.x-county-state.x-deaths-ln_cases-households, data =glmdata )
lm4 = glm.nb(cases ~.-fips.x-county-state.x-deaths-ln_cases-totalhouseholds, data =glmdata )
summary(lm4)
yhat = predict(lm4)
orig = data.frame(cbind(yhat, glmdata$cases))
View(orig)
glmdata$ln_cases = log(cases)
glmdata$ln_cases = log(glmdata$cases)
lm4 = glm.nb(ln_cases ~.-fips.x-county-state.x-deaths-ln_cases-totalhouseholds, data =glmdata )
yhat = predict(lm4)
lm4 = glm.nb(cases ~.-fips.x-county-state.x-deaths-ln_cases-totalhouseholds, data =glmdata )
yhat = predict(lm4)
orig = data.frame(cbind(exp(yhat), glmdata$cases))
View(orig)
